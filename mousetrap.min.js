(function(){function r(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function y(a){return"keypress"==a.type?String.fromCharCode(a.which):h[a.which]?h[a.which]:z[a.which]?z[a.which]:String.fromCharCode(a.which).toLowerCase()}function s(a){a=a||{};var b=!1,c;for(c in k)a[c]?b=!0:k[c]=0;b||(n=!1)}function A(a,b,c,d,I){var g,e,B=[],f=c.type;if(!l[a])return[];"keyup"==f&&t(a)&&(b=[a]);for(g=0;g<l[a].length;++g)if(e=l[a][g],!(e.seq&&k[e.seq]!=e.level)&&f==e.action&&("keypress"==
f&&!c.metaKey&&!c.ctrlKey||b.sort().join(",")===e.modifiers.sort().join(",")))d&&e.combo==I&&l[a].splice(g,1),B.push(e);return B}function u(a,b,c){if(!v.stopCallback(b,b.target||b.srcElement,c)&&!1===a(b,c))b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.returnValue=!1,b.cancelBubble=!0}function w(a){"number"!==typeof a.which&&(a.which=a.keyCode);var b=y(a);if(b)if("keyup"==a.type&&x==b)x=!1;else{var c=[];a.shiftKey&&c.push("shift");a.altKey&&c.push("alt");a.ctrlKey&&
c.push("ctrl");a.metaKey&&c.push("meta");var c=A(b,c,a),d,f={},g=!1;for(d=0;d<c.length;++d)c[d].seq?(g=!0,f[c[d].seq]=1,u(c[d].callback,a,c[d].combo)):!g&&!n&&u(c[d].callback,a,c[d].combo);a.type==n&&!t(b)&&s(f)}}function t(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function C(a,b,c){if(!c){if(!p){p={};for(var d in h)95<d&&112>d||h.hasOwnProperty(d)&&(p[h[d]]=d)}c=p[a]?"keydown":"keypress"}"keypress"==c&&b.length&&(c="keydown");return c}function J(a,b,c,d){k[a]=0;d||(d=C(b[0],[]));var f=
function(b){n=d;++k[a];clearTimeout(D);D=setTimeout(s,1E3)},g=function(b){u(c,b,a);"keyup"!==d&&(x=y(b));setTimeout(s,10)},e;for(e=0;e<b.length;++e)E(b[e],e<b.length-1?f:g,d,a,e)}function E(a,b,c,d,f){a=a.replace(/\s+/g," ");var g=a.split(" "),e,h,k=[];if(1<g.length)J(a,g,b,c);else{h="+"===a?["+"]:a.split("+");for(g=0;g<h.length;++g)e=h[g],F[e]&&(e=F[e]),c&&("keypress"!=c&&G[e])&&(e=G[e],k.push("shift")),t(e)&&k.push(e);c=C(e,k,c);l[e]||(l[e]=[]);A(e,k,{type:c},!d,a);l[e][d?"unshift":"push"]({callback:b,
modifiers:k,action:c,seq:d,level:f,combo:a})}}for(var H=!1,h={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},z={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},G={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",
")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},F={option:"alt",command:"meta","return":"enter",escape:"esc"},p,l={},m={},k={},D,x=!1,n=!1,q=!1,f=1;20>f;++f)h[111+f]="f"+f;for(f=0;9>=f;++f)h[f+96]=f;r(document,"keypress",w);r(document,"keydown",w);r(document,"keyup",w);var v={bind:function(a,b,c){for(var d=a instanceof Array?a:[a],f=0;f<d.length;++f)E(d[f],b,c);m[a+":"+c]=b;return this},unbind:function(a,b){m[a+":"+b]&&(delete m[a+":"+b],this.bind(a,function(){},b));return this},
trigger:function(a,b){m[a+":"+b]();return this},reset:function(){l={};m={};return this},fireForAllElements:function(a){H=a},stopCallback:function(a,b,c){return q?!0:H||-1<(" "+b.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.contentEditable&&"true"==b.contentEditable},pause:function(){q=!0},resume:function(){q=!1},isPaused:function(){return q}};window.Mousetrap=v;"function"===typeof define&&define.amd&&define("mousetrap",function(){return v})})();
